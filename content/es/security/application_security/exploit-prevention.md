---
aliases:
- /es/security/application_security/threats/exploit-prevention
disable_toc: false
further_reading:
- link: /security/application_security/
  tag: Documentación
  text: Protegerse contra las amenazas con Datadog App and API Protection
- link: /security/application_security/policies/library_configuration/
  tag: Documentación
  text: Otras consideraciones de configuración y opciones de configuración
- link: https://www.datadoghq.com/blog/datadog-exploit-prevention/
  tag: Blog
  text: Protege tus aplicaciones de los ataques desde el primer día con Datadog Exploit
    Prevention
- link: https://www.datadoghq.com/blog/understanding-your-waf/
  tag: Blog
  text: 'Comprender tu WAF: cómo solucionar las lagunas más comunes en la seguridad
    de las aplicaciones web'
title: Prevención de vulnerabilidades
---

{{< learning-center-callout header="Obtén barreras de seguridad en tiempo real para tus aplicaciones y agents de IA" btn_title="Únete a la vista previa" hide_image="true" btn_url="https://www.datadoghq.com/product-preview/ai-security/">}}
  AI Guard ayuda a proteger tus aplicaciones y agentes de IA en tiempo real frente a ataques de inyección inmediata, jailbreaking, uso indebido de herramientas y exfiltración de datos confidenciales. ¡Pruébalo hoy mismo!
{{< /learning-center-callout >}}

## Información general

Utiliza **Exploit Prevention** de App and API Protection para proteger tus aplicaciones y APIs críticas frente a vulnerabilidades de día cero sin necesidad de realizar ajustes ni reconfiguraciones. 

Gracias a las funciones contextuales de App and API Protection, podrás conocer en profundidad la lógica, el flujo de datos y el estado de las aplicaciones.

Combina la telemetría del rastreador Datadog con la heurística predefinida para detectar y bloquear vulnerabilidades con mayor precisión, lo cual garantiza que el tráfico legítimo no se vea afectado.

Esto es posible gracias a Runtime Application Self Protection (RASP), que permite detectar y prevenir ataques en tiempo real.

Para obtener más información sobre las diferencias entre Exploit Prevention e In-App WAF, consulta [Exploit Prevention vs. In-App WAF][12].

## Cómo funciona la prevención de vulnerabilidades

1. Con la biblioteca de rastreo de Datadog App and API Protection instrumentada en tus aplicaciones, se capturan detalles sobre cada interacción dentro de la aplicación, incluyendo solicitudes, ejecución de código y flujos de datos.
2. Cuando una carga útil de ataque llega a la aplicación, App and API Protection evalúa si la carga útil activa rutas de código vinculadas a vulnerabilidades conocidas.
3. Si se detecta una posible vulnerabilidad:
   1. App and API Protection bloquea la solicitud en tiempo real antes de que cause daños.
   2. App and API Protection emite señales de seguridad para su posterior investigación.
4. Las detecciones de prevención de vulnerabilidades van acompañadas de stack traces que proporcionan una visibilidad completa de la ubicación del código de la vulnerabilidad, que proporciona un camino libre hacia la corrección. 

### Ejemplo 1: Falsificación de solicitudes del lado del servidor

Un atacante engaña al servidor para que realice solicitudes no autorizadas a sistemas internos o servidores externos, lo que puede filtrar información o permitir una explotación posterior.

App and API Protection Exploit Prevention comprueba si la URL de una solicitud interna o externa, controlada parcial o totalmente por un parámetro de usuario, ha sido manipulada por un atacante para alterar el propósito original de la solicitud.

### Ejemplo 2: Inclusión de archivos locales

Un atacante vulnera un parámetro vulnerable para incluir archivos locales del servidor, lo cual posiblemente exponga datos confidenciales como archivos de configuración o posiblemente permita la ejecución remota del código.

App and API Protection Exploit Prevention inspecciona todos los intentos de acceso a archivos para determinar si se ha inyectado la ruta y si se accede a un archivo restringido.

### Ejemplo 3: Inserción de SQL

Un atacante inserta un código malicioso de SQL en una consulta, con lo que puede obtener acceso no autorizado a la base de datos, manipular datos o ejecutar operaciones administrativas.

Exploit Prevention de App and API Protection intercepta todas las consultas SQL para determinar si se ha inyectado un parámetro de usuario y si la inyección altera el propósito y la estructura originales de la consulta SQL.

## Requisitos previos

- Asegúrate de que tus aplicaciones estén instrumentadas con el rastreador de Datadog.
- App and API Protection debe estar activada. Consulta [Configuración][1].
- Asegúrate de que la configuración remota está habilitada para enviar actualizaciones de reglas y políticas de In-App WAF. Consulta [Habilitar la configuración remota][2].

### Compatibilidad de bibliotecas


| Tipo de vulnerabilidad                       | [.NET][5]        | [Python][6]      | [Go][7]                 | [Java][8]        | [Node.js][9]     | [PHP][10]        | [Ruby][11]        |
|------------------------------------|------------------|------------------|-------------------------|------------------|------------------|------------------|-------------------|
| Falsificación de solicitudes del lado del servidor (SSRF) | v3.3.0           | v2.15.0          | v1.70.1                 | v1.42.0          | v5.20.0, v4.44.0 | v1.9.0           | v2.15.0           |
| Inclusión de archivos locales (LFI)         | v3.5.0           | v2.15.0          | [orchestrion][3] v1.0.0 | v1.42.0          | v5.24.0, v4.48.0 | v1.9.0           | No compatible     |
| Inserción de SQL (SQLi)               | v3.4.0           | v2.16.0          | v1.70.1                 | v1.42.0          | v5.25.0, v4.49.0 | v1.9.0           | v2.15.0           |
| Inserción de comandos                  | v3.4.0           | v2.15.0          | No compatible           | v1.45.0          | v5.25.0, v4.49.0 | No compatible    | No compatible     |


## Activación de la prevención de vulnerabilidades


1. Ve a [In-App WAF][4].
2. Si has aplicado una política administrada por Datadog a tus servicios, sigue estos pasos:
   1. Clona la política. Por ejemplo, puedes utilizar la política **Managed - Block attack tools** (Administrada - Bloquear herramientas de ataque).
   1. Añade un nombre y una descripción de la política.
   1. Haz clic en la política que has creado y selecciona el conjunto de reglas **Local File Inclusion** (Inclusión de archivos locales). Habilita el bloqueo de la regla **Local File Inclusion exploit** (Explotación de la Inclusión de archivos locales).
   1. Del mismo modo, selecciona el conjunto de reglas **Server-side Request Forgery** (Falsificación de solicitudes del lado del servidor) y activa el bloqueo para la regla de explotación de **Server-side request forgery** (Falsificación del lado del servidor).
3. Si has aplicado una política personalizada para tus servicios, puedes omitir los pasos 2.a y 2.b para clonar una política y establecer directamente las reglas de Prevención de vulnerabilidades en el modo **bloqueo** (pasos 2.c y 2.d).


## Revisión de los intentos de explotación en App and API Protection

Una vez activada Exploit Prevention, si App and API Protection detecta un intento de exploit, procede a bloquear esa solicitud. Las detecciones de Exploit Prevention siempre van acompañadas de stack traces, que proporcionan una visibilidad completa de dónde se encuentra la vulnerabilidad en tu código, asegurando un camino claro para la corrección.

<!-- {{< img src="security/application_security/threats/exploit-prevention-detection.png" alt="Detección de Exploit Prevention" width="100%" >}} -->

Además, App and API Protection también genera una señal que correlaciona todas las trazas bloqueadas y aísla las direcciones IP atacantes que tienen como objetivo tu(s) servicio(s). Puedes tomar acción bloqueando todas las IP atacantes.

<!-- {{< img src="security/application_security/threats/signal-correlating-blocked-traces.png" alt="Descripción de tu imagen" width="100%" >}} -->

## Referencias adicionales

{{< partial name="whats-next/whats-next.html" >}}

[1]: /es/security/application_security/setup
[2]: /es/tracing/guide/remote_config
[3]: /es/tracing/trace_collection/automatic_instrumentation/dd_libraries/go/#overview
[4]: https://app.datadoghq.com/security/appsec/in-app-waf
[5]: https://github.com/DataDog/dd-trace-dotnet
[6]: https://github.com/DataDog/dd-trace-py
[7]: https://github.com/DataDog/dd-trace-go
[8]: https://github.com/DataDog/dd-trace-java
[9]: https://github.com/DataDog/dd-trace-js
[10]: https://github.com/DataDog/dd-trace-php
[11]: https://github.com/DataDog/dd-trace-rb
[12]: /es/security/application_security/#exploit-prevention-vs-in-app-waf