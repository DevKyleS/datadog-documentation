---
disable_toc: false
further_reading:
- link: /security/application_security/
  tag: Documentación
  text: Protegerse contra las amenazas con Datadog App and API Protection
- link: /security/application_security/threats/library_configuration/
  tag: Documentación
  text: Otras consideraciones de configuración y opciones de configuración
- link: https://www.datadoghq.com/blog/datadog-exploit-prevention/
  tag: Blog
  text: Protege tus aplicaciones de los ataques desde el primer día con Datadog Exploit
    Prevention
- link: https://www.datadoghq.com/blog/understanding-your-waf/
  tag: Blog
  text: 'Comprender tu WAF: cómo solucionar las lagunas más comunes en la seguridad
    de las aplicaciones web'
title: Prevención de vulnerabilidades
---


## Información general

Utiliza **Exploit Prevention** de AAP para proteger tus aplicaciones y APIs críticas contra vulnerabilidades desde el primer día sin necesidad de ajustes ni reconfiguraciones.

Gracias a las funciones de AAP que tienen en cuenta el contexto, podrás conocer en profundidad la lógica, el flujo de datos y el estado de las aplicaciones.

Combina la telemetría del rastreador Datadog con la heurística predefinida para detectar y bloquear vulnerabilidades con mayor precisión, lo cual garantiza que el tráfico legítimo no se vea afectado.

## Cómo funciona la prevención de vulnerabilidades

1. Con la biblioteca de rastreo Datadog AAP instrumentada en tus aplicaciones, se capturan detalles sobre cada interacción en la aplicación, incluidas solicitudes, ejecución de códigos y flujos de datos.
2. Cuando una carga útil de ataque llega a la aplicación, AAP evalúa si la carga útil activa rutas de código vinculadas a vulnerabilidades conocidas.
3. Si se detecta una posible vulnerabilidad:
   1. AAP bloquea la solicitud en tiempo real antes de que cause daños.
   2. La AAP plantea señales de seguridad para una investigación más a fondo.
4. Las detecciones de prevención de vulnerabilidades van acompañadas de stack traces que proporcionan una visibilidad completa de la ubicación del código de la vulnerabilidad, que proporciona un camino libre hacia la corrección. 

### Ejemplo 1: Falsificación de solicitudes del lado del servidor

Un atacante engaña al servidor para que realice solicitudes no autorizadas a sistemas internos o servidores externos, lo que puede suponer una fuga de información o una vulnerabilidad posterior.

Exploit Prevention de AAP comprueba si un atacante ha manipulado la URL de una solicitud interna o externa, controlada parcial o totalmente por un parámetro de usuario, para alterar el objetivo original de la solicitud.

### Ejemplo 2: Inclusión de archivos locales

Un atacante vulnera un parámetro vulnerable para incluir archivos locales del servidor, lo cual posiblemente exponga datos confidenciales como archivos de configuración o posiblemente permita la ejecución remota del código.

Exploit Prevention de AAP inspecciona todos los intentos de acceso a archivos para determinar si se ha insertado la ruta y si se accede a un archivo restringido.

### Ejemplo 3: Inserción de SQL

Un atacante inserta un código malicioso de SQL en una consulta, con lo que puede obtener acceso no autorizado a la base de datos, manipular datos o ejecutar operaciones administrativas.

Exploit Prevention de AAP intercepta todas las consultas SQL para determinar si se ha inyectado un parámetro de usuario y si la inyección altera el propósito y la estructura originales de la consulta SQL.

## Requisitos previos

- Asegúrate de que tus aplicaciones estén instrumentadas con el rastreador de Datadog.
- App and API Protection debe estar activada. Consulta [Configuración de App and API Protection][1].
- Asegúrate de que la configuración remota está habilitada para enviar actualizaciones de reglas y políticas de In-App WAF. Consulta [Habilitar la configuración remota][2].

### Compatibilidad de bibliotecas


| Tipo de vulnerabilidad                       | .NET             | Python           | Go                      | Java             | Node.js          | PHP              | Ruby              |
|------------------------------------|------------------|------------------|-------------------------|------------------|------------------|------------------|-------------------|
| Falsificación de solicitudes del lado del servidor (SSRF) | v3.3.0           | v2.15.0           | v1.70.1                 | v1.42.0          | v5.20.0, v4.44.0 | Disponible en Q1 '25 | Disponible en Q1 '25 |
| Inclusión de archivos locales (LFI)         | v3.5.0           | v2.15.0           | [orchestrion][3] v1.0.0 | v1.42.0          | v5.24.0, v4.48.0 | Disponible en Q1 '25 | Disponible en Q1 '25 |
| Inserción de SQL (SQLi)               | v3.4.0           | v2.16.0          | v1.70.1                 | v1.42.0          | v5.25.0, v4.49.0 | Disponible en Q1 '25 | Disponible en Q4 '24 |
| Inserción de comandos                  | v3.4.0           | v2.15.0          | Disponible en Q4 '24        | v1.45.0          | v5.25.0, v4.49.0 | Disponible en Q1 '25 | Disponible en Q1 '25 |

## Activación de la prevención de vulnerabilidades


1. Ve a [In-App WAF][4] (**Security > App and API Protection > Protection > In-App WAF** (Seguridad > API and API Protection > Protección > In-App WAF**).
2. Si has aplicado una política administrada por Datadog a tus servicios, sigue estos pasos:
   a. Clona la política. Por ejemplo, puedes utilizar la política de **Herramientas de bloqueo de ataque - Administrado**.

    {{< img src="security/application_security/threats/clone-política.png" alt="Clona la política" width="100%" >}}
   b. Añade un nombre y una descripción de la política.

    {{< img src="security/application_security/threats/clone-política-modal.png" alt="Clona la política" width="100%" >}}
   c. Haz clic en la política que has creado y selecciona el conjunto de reglas **Inclusión de archivo local**. Habilita el bloqueo para la regla **Vulnerabilidad de inclusión de archivo local**.

    {{< img src="security/application_security/threats/local-file-inclusion.png" alt="Inclusión de archivo local" width="100%" >}}
   d. Del mismo modo, selecciona el conjunto de reglas **Falsificación de solicitudes del lado del servidor** y habilita el bloqueo para la regla de vulnerabilidades **Falsificación de solicitudes del lado del servidor**.

    {{< img src="security/application_security/threats/server-side-request-forgery.png" alt="Vulnerabilidad de la falsificación de solicitudes del lado del servidor" width="100%" >}}
3. Si has aplicado una política personalizada para tus servicios, puedes omitir los pasos 2.a y 2.b para clonar una política y establecer directamente las reglas de Prevención de vulnerabilidades en el modo **bloqueo** (pasos 2.c y 2.d).


## Revisión de los intentos de explotación en AAP

Una vez activada Exploit Prevention, si AAP detecta un intento de vulnerabilidad, procede a bloquear esa solicitud. Las detecciones de Exploit Prevention siempre van acompañadas de stack traces, que proporcionan una visibilidad completa del lugar donde está la vulnerabilidad en tu código, lo cual asegura un camino libre a la corrección.

{{< img src="security/application_security/threats/exploit-prevention-detection.png" alt="Detección de prevención de vulnerabilidades" width="100%" >}}

Además, AAP también genera una señal correlacionando todas las trazas bloqueadas y aislando las direcciones IP atacantes que están apuntando a tu servicio(s). Puedes tomar medidas bloqueando todas las IP atacantes.

{{< img src="security/application_security/threats/signal-correlating-blocked-traces.png" alt="Descripción de tu mensaje" width="100%" >}}

## Referencias adicionales

{{< partial name="whats-next/whats-next.html" >}}

[1]: /es/security/application_security/setup
[2]: /es/agent/remote_config/?tab=configurationyamlfile#enabling-remote-configuration
[3]: /es/tracing/trace_collection/automatic_instrumentation/dd_libraries/go/#overview
[4]: https://app.datadoghq.com/security/appsec/in-app-waf